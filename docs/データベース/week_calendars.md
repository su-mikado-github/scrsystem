# 週カレンダー (week_calendars)

## テーブル情報

| 項目                           | 値                                                                                                   |
|:-------------------------------|:-----------------------------------------------------------------------------------------------------|
| システム名                     | 学食予約システム                                                                                     |
| サブシステム名                 |                                                                                                      |
| 論理エンティティ名             | 週カレンダー                                                                                         |
| 物理エンティティ名             | week_calendars                                                                                       |
| 作成者                         | Shuji Ushiyama                                                                                       |
| 作成日                         | 2023/06/25                                                                                           |
| タグ                           | ビュー                                                                                               |



## カラム情報

| No. | 論理名                         | 物理名                         | データ型                       | Not Null | デフォルト           | 備考                           |
|----:|:-------------------------------|:-------------------------------|:-------------------------------|:---------|:---------------------|:-------------------------------|
|   1 | カレンダーID                   | id                             |                                |          |                      |                                |
|   2 | 日付                           | date                           |                                |          |                      |                                |
|   3 | 年                             | year                           |                                |          |                      |                                |
|   4 | 月                             | month                          |                                |          |                      |                                |
|   5 | 日                             | day                            |                                |          |                      |                                |
|   6 | 曜日                           | weekday                        |                                |          |                      |                                |
|   7 | 曜日月内回数                   | week_of_month                  |                                |          |                      |                                |
|   8 | 曜日年内回数                   | week_of_year                   |                                |          |                      |                                |
|   9 | 祝日フラグ                     | is_holiday                     |                                |          |                      |                                |
|  10 | 祝日名                         | holiday_name                   |                                |          |                      |                                |
|  11 | 週日曜日日付                   | week_start_date                |                                |          |                      |                                |
|  12 | 週土曜日日付                   | week_end_date                  |                                |          |                      |                                |



## ソース
```
select
  T.id -- カレンダーID
  , T.date -- 日付
  , T.year -- 年
  , T.month -- 月
  , T.day -- 日
  , T.weekday -- 曜日
  , T.week_of_month -- 曜日月内回数
  , T.week_of_year -- 曜日年内回数
  , T.is_holiday -- 祝日フラグ
  , T.holiday_name -- 祝日名
  , (
    select
      MAX(ST1.date)
    from
      calendars ST1
    where
      ST1.date >= DATE_SUB(T.date, interval 6 day)
      and ST1.weekday = 7
      and ST1.date <= T.date
  ) as week_start_date -- 週日曜日日付
  , (
    select
      MIN(ST2.date)
    from
      calendars ST2
    where
      ST2.date <= DATE_ADD(T.date, interval 6 day)
      and ST2.weekday = 6
  ) as week_end_date -- 週土曜日日付
from
  calendars T

```



## インデックス情報

| No. | インデックス名                 | カラムリスト                             | ユニーク   | オプション                     | 
|----:|:-------------------------------|:-----------------------------------------|:-----------|:-------------------------------|



## リレーションシップ情報

| No. | 動詞句                         | カラムリスト                             | 参照先                         | 参照先カラムリスト                       |
|----:|:-------------------------------|:-----------------------------------------|:-------------------------------|:-----------------------------------------|



## リレーションシップ情報(PK側)

| No. | 動詞句                         | カラムリスト                             | 参照元                         | 参照元カラムリスト                       |
|----:|:-------------------------------|:-----------------------------------------|:-------------------------------|:-----------------------------------------|
|   1 |                                | year,month,day                           | calendars                      | year,month,day                           |


